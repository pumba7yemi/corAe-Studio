// corAe Purchase Orders™ — Replenishment & Inbound
enum PurchaseStatus { DRAFT APPROVED ORDERED RECEIVED PARTIAL CLOSED CANCELLED }

model PurchaseOrder {
  id            String         @id @default(cuid())
  companyId     String
  poNo          String         @unique
  vendorId      String
  status        PurchaseStatus @default(DRAFT)
  expectedAt    DateTime?
  currency      String         @default("AED")
  notes         String?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt

  company       CompanyIdentity @relation(fields: [companyId], references: [id], onDelete: Cascade)
  vendor        Party           @relation(fields: [vendorId], references: [id], onDelete: Restrict)
  lines         PurchaseLine[]
}

model PurchaseLine {
  id           String        @id @default(cuid())
  purchaseId   String
  skuId        String
  qty          Decimal       @db.Decimal(12,3)
  costA        Decimal       @db.Decimal(14,4)
  vatRate      Decimal?      @db.Decimal(5,2)
  vatAmount    Decimal?      @db.Decimal(14,4)
  lineTotal    Decimal       @db.Decimal(14,4)
  receivedQty  Decimal       @db.Decimal(12,3) @default(0)

  purchase     PurchaseOrder @relation(fields: [purchaseId], references: [id], onDelete: Cascade)
  sku          Sku           @relation(fields: [skuId], references: [id], onDelete: Restrict)
}